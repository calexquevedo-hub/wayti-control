import{r as d,j as e,C as S,h as I,i as D,k as L,B as h,I as n,q as M,D as $,m as U,n as B,o as F,E as R}from"./index-DESoNwQK.js";import{B as z}from"./badge-BZPWyFCa.js";import{T as O,a as P,b as v,c as b}from"./tabs-OU8pq1yq.js";const G={InUse:"default",InStock:"secondary",Maintenance:"warning",Retired:"outline",Lost:"warning"};function K({assets:N,tickets:f,users:i=[],onCreate:E,onUpdate:C}){const[o,A]=d.useState(""),[c,k]=d.useState("all"),[x,H]=d.useState("all"),[l,u]=d.useState(null),[V,m]=d.useState(!1),[g,y]=d.useState(!1),[r,t]=d.useState({tag:"",name:"",serialNumber:"",type:"Hardware",brand:"",model:"",purchaseDate:"",purchaseValue:"",warrantyExpiresAt:"",status:"InUse",location:"",assignedToId:""}),w=d.useMemo(()=>N.filter(a=>{const s=!o.trim()||`${a.tag} ${a.name} ${a.serialNumber??""} ${a.assignedTo?.name??""}`.toLowerCase().includes(o.toLowerCase()),p=c==="all"||a.status===c,j=x==="all"||a.type===x;return s&&p&&j}),[N,o,c,x]),T=d.useMemo(()=>l?f.filter(a=>a.relatedAssetId===l.id):[],[f,l]);return e.jsxs("div",{className:"grid gap-6 lg:grid-cols-[1.4fr_1fr]",children:[e.jsxs(S,{className:"bg-card/70",children:[e.jsxs(I,{children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[e.jsxs("div",{children:[e.jsx(D,{children:"Ativos"}),e.jsx(L,{children:"InventÃ¡rio de hardware e licenÃ§as."})]}),e.jsx(h,{size:"sm",onClick:()=>m(!0),children:"Novo ativo"})]}),e.jsxs("div",{className:"mt-3 grid gap-3 lg:grid-cols-3",children:[e.jsx(n,{value:o,onChange:a=>A(a.target.value),placeholder:"ðŸ” Buscar por nome, tag ou serial..."}),e.jsxs("select",{className:"h-10 rounded-md border border-input bg-transparent px-3 text-sm",value:c,onChange:a=>k(a.target.value),children:[e.jsx("option",{value:"all",children:"Todas as situaÃ§Ãµes"}),["InUse","InStock","Maintenance","Retired","Lost"].map(a=>e.jsx("option",{value:a,children:a},a))]}),e.jsxs("select",{className:"h-10 rounded-md border border-input bg-transparent px-3 text-sm",value:x,onChange:a=>H(a.target.value),children:[e.jsx("option",{value:"all",children:"Todos os tipos"}),["Hardware","Software","License","Peripheral","Mobile"].map(a=>e.jsx("option",{value:a,children:a},a))]})]})]}),e.jsx(M,{className:"space-y-3 text-sm text-muted-foreground",children:w.length===0?e.jsx("p",{children:"Nenhum ativo encontrado."}):w.map(a=>e.jsxs("div",{className:`rounded-lg border p-4 transition ${l?.id===a.id?"border-primary/50 bg-primary/5":"border-border/60 bg-background/40 hover:border-border"}`,onClick:()=>{u(a),y(!1)},children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-semibold text-foreground",children:[a.tag," â€¢ ",a.name]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[a.brand??"-"," ",a.model??""]})]}),e.jsx(z,{variant:G[a.status],children:a.status})]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-4 text-xs text-muted-foreground",children:[e.jsxs("span",{children:["Tipo: ",a.type]}),e.jsxs("span",{children:["Serial: ",a.serialNumber??"-"]}),e.jsxs("span",{children:["UsuÃ¡rio: ",a.assignedTo?.name??"NÃ£o atribuÃ­do"]}),e.jsxs("span",{children:["Local: ",a.location??"-"]})]})]},a.id))})]}),e.jsxs(S,{className:"bg-card/70",children:[e.jsxs(I,{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(D,{children:"Detalhe do ativo"}),l?e.jsx(h,{size:"sm",variant:"outline",onClick:()=>y(a=>!a),children:g?"Fechar ediÃ§Ã£o":"Editar"}):null]}),e.jsx(L,{children:l?`${l.tag} â€¢ ${l.name}`:"Selecione um ativo para ver detalhes."})]}),e.jsx(M,{className:"space-y-4 text-sm text-muted-foreground",children:l?e.jsxs(O,{defaultValue:"geral",children:[e.jsxs(P,{children:[e.jsx(v,{value:"geral",children:"Geral"}),e.jsx(v,{value:"historico",children:"HistÃ³rico"}),e.jsx(v,{value:"chamados",children:"Chamados"})]}),e.jsx(b,{value:"geral",children:e.jsxs("div",{className:"grid gap-3",children:[e.jsxs("div",{className:"grid gap-1",children:[e.jsx("label",{className:"text-xs text-muted-foreground",children:"Status"}),e.jsx("select",{className:"h-9 rounded-md border border-input bg-transparent px-2 text-xs",value:l.status,onChange:async a=>{const s=a.target.value;await C(l.id,{status:s}),u({...l,status:s})},disabled:!g,children:["InUse","InStock","Maintenance","Retired","Lost"].map(a=>e.jsx("option",{value:a,children:a},a))})]}),e.jsxs("div",{className:"grid gap-1",children:[e.jsx("label",{className:"text-xs text-muted-foreground",children:"LocalizaÃ§Ã£o"}),e.jsx(n,{value:l.location??"",onChange:a=>u({...l,location:a.target.value}),disabled:!g})]}),e.jsxs("div",{className:"grid gap-1",children:[e.jsx("label",{className:"text-xs text-muted-foreground",children:"UsuÃ¡rio atual"}),g?e.jsxs("select",{className:"h-9 rounded-md border border-input bg-transparent px-2 text-xs",value:l.assignedTo?.id??"",onChange:async a=>{const s=a.target.value||void 0;await C(l.id,{assignedToId:s});const p=i.find(j=>j.id===s)?.name;u({...l,assignedTo:s?{id:s,name:p??s,email:""}:void 0})},children:[e.jsx("option",{value:"",children:"NÃ£o atribuÃ­do"}),i.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]}):e.jsx(n,{value:l.assignedTo?.name??"NÃ£o atribuÃ­do",disabled:!0})]})]})}),e.jsx(b,{value:"historico",children:e.jsx("div",{className:"space-y-3",children:l.assignmentHistory?.length?l.assignmentHistory.slice().reverse().map((a,s)=>e.jsxs("div",{className:"rounded-md border border-border/60 bg-background/40 p-3",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:a.userName??"Sem usuÃ¡rio"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[a.at.toLocaleString("pt-BR")," â€¢ ",a.notes??"MovimentaÃ§Ã£o"]})]},`${a.at}-${s}`)):e.jsx("p",{className:"text-xs text-muted-foreground",children:"Sem histÃ³rico registrado."})})}),e.jsx(b,{value:"chamados",children:e.jsx("div",{className:"space-y-3",children:T.length===0?e.jsx("p",{className:"text-xs text-muted-foreground",children:"Nenhum chamado vinculado."}):T.map(a=>e.jsxs("div",{className:"rounded-md border border-border/60 bg-background/40 p-3",children:[e.jsxs("p",{className:"text-sm font-medium text-foreground",children:[a.code," â€¢ ",a.subject]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Status: ",a.status," â€¢ Prioridade: ",a.priority]})]},a.id))})})]}):null})]}),e.jsx($,{open:V,onOpenChange:m,children:e.jsxs(U,{className:"max-w-2xl",children:[e.jsx(B,{children:e.jsx(F,{children:"Novo ativo"})}),e.jsxs("div",{className:"grid gap-3 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"grid gap-1",children:[e.jsx("label",{children:"Tag *"}),e.jsx(n,{value:r.tag,onChange:a=>t(s=>({...s,tag:a.target.value}))})]}),e.jsxs("div",{className:"grid gap-1",children:[e.jsx("label",{children:"Nome *"}),e.jsx(n,{value:r.name,onChange:a=>t(s=>({...s,name:a.target.value}))})]}),e.jsxs("div",{className:"grid gap-3 lg:grid-cols-2",children:[e.jsxs("div",{className:"grid gap-1",children:[e.jsx("label",{children:"Tipo *"}),e.jsx("select",{className:"h-10 rounded-md border border-input bg-transparent px-3 text-sm",value:r.type,onChange:a=>t(s=>({...s,type:a.target.value})),children:["Hardware","Software","License","Peripheral","Mobile"].map(a=>e.jsx("option",{value:a,children:a},a))})]}),e.jsxs("div",{className:"grid gap-1",children:[e.jsx("label",{children:"Status"}),e.jsx("select",{className:"h-10 rounded-md border border-input bg-transparent px-3 text-sm",value:r.status,onChange:a=>t(s=>({...s,status:a.target.value})),children:["InUse","InStock","Maintenance","Retired","Lost"].map(a=>e.jsx("option",{value:a,children:a},a))})]})]}),e.jsxs("div",{className:"grid gap-3 lg:grid-cols-2",children:[e.jsxs("div",{className:"grid gap-1",children:[e.jsx("label",{children:"Marca"}),e.jsx(n,{value:r.brand,onChange:a=>t(s=>({...s,brand:a.target.value}))})]}),e.jsxs("div",{className:"grid gap-1",children:[e.jsx("label",{children:"Modelo"}),e.jsx(n,{value:r.model,onChange:a=>t(s=>({...s,model:a.target.value}))})]})]}),e.jsxs("div",{className:"grid gap-3 lg:grid-cols-2",children:[e.jsxs("div",{className:"grid gap-1",children:[e.jsx("label",{children:"NÃºmero de sÃ©rie"}),e.jsx(n,{value:r.serialNumber,onChange:a=>t(s=>({...s,serialNumber:a.target.value}))})]}),e.jsxs("div",{className:"grid gap-1",children:[e.jsx("label",{children:"LocalizaÃ§Ã£o"}),e.jsx(n,{value:r.location,onChange:a=>t(s=>({...s,location:a.target.value}))})]})]}),e.jsxs("div",{className:"grid gap-1",children:[e.jsx("label",{children:"UsuÃ¡rio atual"}),e.jsxs("select",{className:"h-10 rounded-md border border-input bg-transparent px-3 text-sm",value:r.assignedToId,onChange:a=>t(s=>({...s,assignedToId:a.target.value})),disabled:i.length===0,children:[e.jsx("option",{value:"",children:"NÃ£o atribuÃ­do"}),i.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]}),i.length===0?e.jsx("p",{className:"text-[11px] text-muted-foreground",children:"DisponÃ­vel apenas para administradores."}):null]}),e.jsxs("div",{className:"grid gap-3 lg:grid-cols-3",children:[e.jsxs("div",{className:"grid gap-1",children:[e.jsx("label",{children:"Compra"}),e.jsx(n,{type:"date",value:r.purchaseDate,onChange:a=>t(s=>({...s,purchaseDate:a.target.value}))})]}),e.jsxs("div",{className:"grid gap-1",children:[e.jsx("label",{children:"Valor"}),e.jsx(n,{type:"number",value:r.purchaseValue,onChange:a=>t(s=>({...s,purchaseValue:a.target.value}))})]}),e.jsxs("div",{className:"grid gap-1",children:[e.jsx("label",{children:"Garantia"}),e.jsx(n,{type:"date",value:r.warrantyExpiresAt,onChange:a=>t(s=>({...s,warrantyExpiresAt:a.target.value}))})]})]})]}),e.jsxs(R,{children:[e.jsx(h,{variant:"secondary",onClick:()=>m(!1),children:"Cancelar"}),e.jsx(h,{onClick:async()=>{!r.tag.trim()||!r.name.trim()||(await E({tag:r.tag.trim(),name:r.name.trim(),serialNumber:r.serialNumber||void 0,type:r.type,brand:r.brand||void 0,model:r.model||void 0,purchaseDate:r.purchaseDate?new Date(r.purchaseDate):void 0,purchaseValue:r.purchaseValue?Number(r.purchaseValue):void 0,warrantyExpiresAt:r.warrantyExpiresAt?new Date(r.warrantyExpiresAt):void 0,status:r.status,location:r.location||void 0,assignedToId:r.assignedToId||void 0}),t({tag:"",name:"",serialNumber:"",type:"Hardware",brand:"",model:"",purchaseDate:"",purchaseValue:"",warrantyExpiresAt:"",status:"InUse",location:"",assignedToId:""}),m(!1))},children:"Salvar"})]})]})})]})}export{K as Assets};
