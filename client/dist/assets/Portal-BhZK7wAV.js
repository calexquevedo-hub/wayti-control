import{r as o,j as e,C as m,h as p,i as h,k as j,q as b,I as D,D as k,m as w,n as A,o as I,E as L,B as f}from"./index-DESoNwQK.js";import{T}from"./textarea-1YYYT-yv.js";function O({services:l,articles:n,onCreateTicket:N}){const[a,v]=o.useState(""),[s,C]=o.useState(null),[S,d]=o.useState(!1),[c,u]=o.useState(""),x=o.useMemo(()=>a.trim()?l.filter(r=>`${r.title} ${r.description??""}`.toLowerCase().includes(a.toLowerCase())):l.filter(r=>r.isVisible),[l,a]),g=o.useMemo(()=>a.trim()?n.filter(r=>`${r.title} ${r.body}`.toLowerCase().includes(a.toLowerCase())):n.slice(0,6),[n,a]),y=o.useMemo(()=>x.reduce((r,i)=>{const t=i.category;return r[t]||(r[t]=[]),r[t].push(i),r},{}),[x]);return e.jsxs("div",{className:"grid gap-6",children:[e.jsxs(m,{className:"bg-card/70",children:[e.jsxs(p,{children:[e.jsx(h,{children:"Portal de ServiÃ§os"}),e.jsx(j,{children:"Como podemos ajudar hoje?"})]}),e.jsxs(b,{className:"space-y-4",children:[e.jsx(D,{value:a,onChange:r=>v(r.target.value),placeholder:"ðŸ” Buscar por serviÃ§os ou artigos..."}),e.jsx("div",{className:"grid gap-4 lg:grid-cols-3",children:Object.entries(y).map(([r,i])=>e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:r}),i.map(t=>e.jsxs("button",{className:"w-full rounded-lg border border-border/60 bg-background/40 p-3 text-left transition hover:border-primary/50",onClick:()=>{C(t),d(!0)},children:[e.jsx("p",{className:"text-sm font-semibold text-foreground",children:t.title}),e.jsx("p",{className:"text-xs text-muted-foreground",children:t.description||"SolicitaÃ§Ã£o guiada"})]},t.id))]},r))})]})]}),e.jsxs(m,{className:"bg-card/70",children:[e.jsxs(p,{children:[e.jsx(h,{children:"Top artigos"}),e.jsx(j,{children:"Autoajuda mais consultada"})]}),e.jsx(b,{className:"grid gap-3 lg:grid-cols-2",children:g.length===0?e.jsx("p",{className:"text-sm text-muted-foreground",children:"Nenhum artigo encontrado."}):g.map(r=>e.jsxs("div",{className:"rounded-lg border border-border/60 bg-background/40 p-4",children:[e.jsx("p",{className:"text-sm font-semibold text-foreground",children:r.title}),e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-2",children:r.body}),r.relatedServiceId?e.jsxs("p",{className:"mt-2 text-xs text-muted-foreground",children:["ServiÃ§o relacionado: ",r.relatedServiceId.title]}):null]},r.id))})]}),e.jsx(k,{open:S,onOpenChange:d,children:e.jsxs(w,{className:"max-w-2xl",children:[e.jsx(A,{children:e.jsx(I,{children:s?.title??"Novo chamado"})}),e.jsxs("div",{className:"grid gap-3 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"rounded-lg border border-border/60 bg-background/40 p-3 text-xs text-muted-foreground",children:["Prioridade definida pelo catÃ¡logo: ",s?.defaultPriority??"-",e.jsx("br",{}),"SLA padrÃ£o: ",s?.defaultSLA??"-"," horas",s?.requiresApproval?e.jsxs(e.Fragment,{children:[e.jsx("br",{}),"AprovaÃ§Ã£o obrigatÃ³ria: sim"]}):null]}),e.jsxs("div",{className:"grid gap-1",children:[e.jsx("label",{children:"DescriÃ§Ã£o do problema"}),e.jsx(T,{value:c,onChange:r=>u(r.target.value),placeholder:"Descreva o que estÃ¡ acontecendo"})]})]}),e.jsxs(L,{children:[e.jsx(f,{variant:"secondary",onClick:()=>d(!1),children:"Cancelar"}),e.jsx(f,{onClick:async()=>{s&&(await N({subject:s.title,description:c,serviceId:s.id,category:s.category,queue:"TI Interna",status:"Novo",openedAt:new Date,channel:"Portal"}),u(""),d(!1))},children:"Abrir chamado"})]})]})})]})}export{O as Portal};
